---
keywords: fastai
title: Sankey_story
toc: true 
badges: true
comments: true
sticky_rank: 1
author: Thomas PEDOT
image: images/diagram.png
categories: [fastpages, jupytern sankey]
nb_path: _notebooks/.~2021-04-19 - Sankey_story - DP.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/.~2021-04-19 - Sankey_story - DP.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="100%-Elec">100% Elec<a class="anchor-link" href="#100%-Elec"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sur les différentes années de ce projet, la maison et son usage ont évolués, d'un coté l'isolation a été améliorée ponctuellement par certains travaux, d'un autre coté la famille s'est agrandie. Je fais le choix de figer les besoins de la maison en chauffage, ECS et électricité domestique afin de pouvoir comparer différentes configuration sur une base commune.</p>
<p>Par rapport au DPE, j'ai considéré les besoins suivants:</p>
<ul>
<li>Besoin en chauffage : 15 200 kWh annuel, soit +30% par rapport à l'estimation du DPE initial. Cette valeur est estimée à partir du suivi de consommation des factures sur plusieurs années.  Il est cependant difficile de suivre correctement la consommation de bois d'une année sur l'autre. L'estimation du besoin du DPE est fait par rapport à une valeur de consigne de chauffage à 19°C {% fn 1 %}, en pratique nous avons une température de consigne à 21°C.</li>
<li>Production d'ECS 1800kWh annuel. Il est estimée à 600 kWh/personne/an {% fn 2 %}, en considérant 2 adultes et 2 enfants, </li>
<li>Besoin en électricité domestique : 3998kWh annuel. Il est estimé à 1100 kWh/an/personne {% fn 3 %} soit 3300 kWh annuel pour 2 adultes et 2 enfants. Il faut ajouter la consommation spécifique de la piscine, en considérant 6 h de fonctionnement par jour pendant 5 mois et une puissance de pompe de 750 W, la consommation annuelle est de 697 kWh. Ces données sont cohérentes avec les consommations constatées sur plusieurs années.</li>
</ul>
<p>Je vais utiliser des diagrammes Sankey, en partant de la configuration la plus simple ou seule l'électricité est utilisée pour répondre aux besoins de la maison:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ratio_pertes</span> <span class="o">=</span> <span class="mf">2.58</span>
<span class="n">Frac_nucleaire</span><span class="o">=</span><span class="mf">0.65</span>
<span class="n">Frac_ENR_reseau</span><span class="o">=</span><span class="mf">0.25</span>
<span class="n">Frac_gaz</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_ENR_reseau</span><span class="o">-</span><span class="n">Frac_nucleaire</span>


<span class="n">rdt_chaud</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">rdt_insert</span><span class="o">=</span><span class="mf">0.75</span> <span class="c1">#(0.90 sinon)</span>
<span class="n">PV_frac_autoconso</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">nb_pers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Total_chauff_SdB</span> <span class="o">=</span> <span class="mi">15200</span>
<span class="n">Total_ECS</span> <span class="o">=</span> <span class="mi">600</span><span class="o">*</span><span class="n">nb_pers</span>
<span class="n">Total_pompe_piscine</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">31</span><span class="o">*</span><span class="mf">0.750</span>
<span class="n">Total_conso_elec</span> <span class="o">=</span> <span class="mi">1100</span><span class="o">*</span><span class="n">nb_pers</span> <span class="o">+</span> <span class="n">Total_chauff_SdB</span> <span class="o">+</span> <span class="n">Total_ECS</span> <span class="o">+</span> <span class="n">Total_pompe_piscine</span>

<span class="n">Total_conso_elec_reseau</span> <span class="o">=</span> <span class="n">Total_conso_elec</span> <span class="c1">#*PV_frac_autoconso</span>
<span class="n">Part_PAC</span><span class="o">=</span><span class="mi">0</span>
<span class="n">Total_conso_gaz</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Part_PAC</span><span class="p">)</span>
<span class="n">Total_conso_bois</span> <span class="o">=</span> <span class="mi">3500</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Frac_recup_bois</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">Total_prod_PV</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Total_revente_PV</span> <span class="o">=</span> <span class="p">(</span><span class="n">Total_prod_PV</span><span class="o">-</span><span class="n">Total_conso_elec</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">PV_frac_autoconso</span><span class="p">))</span>
<span class="n">Total_charge_batterie</span> <span class="o">=</span> <span class="n">Total_prod_PV</span> <span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_decharge_batterie</span> <span class="o">=</span> <span class="n">Total_charge_batterie</span><span class="o">*</span><span class="mf">0.85</span><span class="o">*</span><span class="mi">0</span>

<span class="n">Total_prod_thermique</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Total_prod_thermique_piscine</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">Total_th_PAC</span> <span class="o">=</span> <span class="mi">10000</span><span class="o">*</span><span class="n">Part_PAC</span>
<span class="n">sCOP</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="mf">2.5</span>

<span class="n">Total_thermique</span> <span class="o">=</span> <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span> <span class="o">+</span> <span class="n">Total_prod_thermique</span> <span class="o">+</span> <span class="n">Frac_recup_bois</span><span class="o">*</span><span class="n">Total_conso_bois</span> <span class="o">+</span> <span class="n">Total_th_PAC</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include sankey_plotly_elec.html %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Elec-+-Bois">Elec + Bois<a class="anchor-link" href="#Elec-+-Bois"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">Ratio_pertes</span> <span class="o">=</span> <span class="mf">2.58</span>
<span class="n">Frac_nucleaire</span><span class="o">=</span><span class="mf">0.65</span>
<span class="n">Frac_ENR_reseau</span><span class="o">=</span><span class="mf">0.25</span>
<span class="n">Frac_gaz</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_ENR_reseau</span><span class="o">-</span><span class="n">Frac_nucleaire</span>

<span class="n">rdt_chaud</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">rdt_insert</span><span class="o">=</span><span class="mf">0.75</span> <span class="c1">#(0.90 sinon)</span>
<span class="n">PV_frac_autoconso</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">nb_pers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Total_conso_bois</span> <span class="o">=</span> <span class="mi">3500</span>
<span class="n">Total_chauff_SdB</span> <span class="o">=</span> <span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span>
<span class="n">Total_ECS</span> <span class="o">=</span> <span class="mi">600</span><span class="o">*</span><span class="n">nb_pers</span>
<span class="n">Total_pompe_piscine</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">31</span><span class="o">*</span><span class="mf">0.750</span>
<span class="n">Total_conso_elec</span> <span class="o">=</span> <span class="mi">1100</span><span class="o">*</span><span class="n">nb_pers</span> <span class="o">+</span> <span class="n">Total_chauff_SdB</span> <span class="o">+</span> <span class="n">Total_ECS</span> <span class="o">+</span> <span class="n">Total_pompe_piscine</span>




<span class="n">Total_conso_elec_reseau</span> <span class="o">=</span> <span class="n">Total_conso_elec</span> <span class="c1">#*PV_frac_autoconso</span>
<span class="n">Part_PAC</span><span class="o">=</span><span class="mi">0</span>
<span class="n">Total_conso_gaz</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Part_PAC</span><span class="p">)</span>

<span class="n">Frac_recup_bois</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">Total_prod_PV</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Total_revente_PV</span> <span class="o">=</span> <span class="p">(</span><span class="n">Total_prod_PV</span><span class="o">-</span><span class="n">Total_conso_elec</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">PV_frac_autoconso</span><span class="p">))</span>
<span class="n">Total_charge_batterie</span> <span class="o">=</span> <span class="n">Total_prod_PV</span> <span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_decharge_batterie</span> <span class="o">=</span> <span class="n">Total_charge_batterie</span><span class="o">*</span><span class="mf">0.85</span><span class="o">*</span><span class="mi">0</span>

<span class="n">Total_prod_thermique</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Total_prod_thermique_piscine</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">Total_th_PAC</span> <span class="o">=</span> <span class="mi">10000</span><span class="o">*</span><span class="n">Part_PAC</span>
<span class="n">sCOP</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="mf">2.5</span>

<span class="n">Total_thermique</span> <span class="o">=</span> <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span> <span class="o">+</span> <span class="n">Total_prod_thermique</span> <span class="o">+</span> <span class="n">Frac_recup_bois</span><span class="o">*</span><span class="n">Total_conso_bois</span> <span class="o">+</span> <span class="n">Total_th_PAC</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
    <span class="n">arrangement</span> <span class="o">=</span> <span class="s2">&quot;snap&quot;</span><span class="p">,</span>
    <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span>
    <span class="n">node</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Non renouvelable&quot;</span><span class="p">,</span>       <span class="c1"># 0</span>
                  <span class="s2">&quot;ENR&quot;</span><span class="p">,</span>                    <span class="c1"># 1</span>
                  <span class="s2">&quot;Nucléaire&quot;</span><span class="p">,</span>              <span class="c1"># 2</span>
                  <span class="s2">&quot;Gaz&quot;</span><span class="p">,</span>                    <span class="c1"># 3</span>
                  <span class="s2">&quot;ENR Réseau&quot;</span><span class="p">,</span>             <span class="c1"># 4</span>
                  <span class="s2">&quot;Photovoltaïque&quot;</span><span class="p">,</span>         <span class="c1"># 5</span>
                  <span class="s2">&quot;Solaire thermique&quot;</span><span class="p">,</span>      <span class="c1"># 6</span>
                  <span class="s2">&quot;Air (PAC)&quot;</span><span class="p">,</span>              <span class="c1"># 7</span>
                  <span class="s2">&quot;Bois&quot;</span><span class="p">,</span>                   <span class="c1"># 8</span>
                  <span class="s2">&quot;Electricité Réseau&quot;</span><span class="p">,</span>     <span class="c1"># 9</span>
                  <span class="s2">&quot;Pertes&quot;</span><span class="p">,</span>                 <span class="c1"># 10</span>
                  <span class="s2">&quot;Electricité domestique&quot;</span><span class="p">,</span> <span class="c1"># 11</span>
                  <span class="s2">&quot;Usage direct&quot;</span><span class="p">,</span>           <span class="c1"># 12</span>
                  <span class="s2">&quot;Batterie&quot;</span><span class="p">,</span>               <span class="c1"># 13</span>
                  <span class="s2">&quot;Revente&quot;</span><span class="p">,</span>                <span class="c1"># 14</span>
                  <span class="s2">&quot;Prod eau chaude&quot;</span><span class="p">,</span>        <span class="c1"># 15</span>
                  <span class="s2">&quot;Chauffage&quot;</span><span class="p">,</span>              <span class="c1"># 16</span>
                  <span class="s2">&quot;ECS&quot;</span><span class="p">,</span>                    <span class="c1"># 17</span>
                  <span class="s2">&quot;Chauffage piscine&quot;</span><span class="p">,</span>      <span class="c1"># 18</span>
                  <span class="s2">&quot;PAC&quot;</span><span class="p">,</span>                    <span class="c1"># 19</span>
                  <span class="s2">&quot;Autre&quot;</span><span class="p">,</span>                  <span class="c1"># 20</span>
                  <span class="s2">&quot;Piscine&quot;</span><span class="p">,</span>          <span class="c1"># 21</span>
                  <span class="s2">&quot;Piscine&quot;</span>                 <span class="c1"># 22</span>
                 <span class="p">],</span>
<span class="c1">#        &quot;x&quot;: [0.2, 0.1, 0.5, 0.7, 0.3, 0.5],</span>
<span class="c1">#        &quot;y&quot;: [0.7, 0.5, 0.2, 0.4, 0.2, 0.3],</span>
        <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">},</span>  <span class="c1"># 10 Pixels</span>
    <span class="n">link</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="mi">2</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span>
                   <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span>
                   <span class="mi">14</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">7</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">21</span>
                  <span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">20</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">21</span><span class="p">,</span>
                   <span class="mi">22</span><span class="p">,</span>
                   <span class="mi">22</span>
                  <span class="p">],</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="o">+</span> <span class="n">Total_conso_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="n">Total_prod_PV</span><span class="p">,</span> <span class="n">Total_prod_thermique</span><span class="o">+</span><span class="n">Total_prod_thermique_piscine</span><span class="p">,</span> <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span> <span class="n">Total_conso_bois</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="c1"># + INJ </span>
                  <span class="n">Total_conso_elec_reseau</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="p">(</span><span class="n">Ratio_pertes</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                  <span class="n">Total_prod_PV</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">*</span><span class="mi">0</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="n">Total_charge_batterie</span><span class="p">,</span> <span class="n">Total_revente_PV</span><span class="p">,</span> <span class="c1">###</span>
                  <span class="n">Total_revente_PV</span><span class="p">,</span>
                  <span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="n">Frac_recup_bois</span><span class="p">,</span>
                  <span class="n">Total_thermique</span><span class="o">-</span><span class="n">Total_ECS</span><span class="p">,</span><span class="n">Total_ECS</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_chauff_SdB</span><span class="p">,</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_recup_bois</span><span class="p">),</span>
                  <span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">-</span><span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="o">-</span><span class="n">Total_chauff_SdB</span><span class="o">-</span><span class="n">Total_pompe_piscine</span>   <span class="o">-</span><span class="n">Total_ECS</span><span class="p">,</span>
                  <span class="n">Total_charge_batterie</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_chaud</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_insert</span><span class="p">),</span>
                  <span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_pompe_piscine</span><span class="o">*</span><span class="mi">0</span>
                 <span class="p">]</span>
    <span class="p">}))</span>

<span class="n">sankey_plotly_elec_bois</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Plotly</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="n">scenarios</span><span class="p">[</span><span class="s1">&#39;Electricité &amp; Bois&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sankey_plotly_elec_bois</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../_includes/sankey_plotly_elec_bois.html&#39;</span>
<span class="n">export_plot_fastpages</span><span class="p">(</span><span class="n">pn</span><span class="o">.</span><span class="n">panel</span><span class="p">(</span><span class="n">sankey_plotly_elec_bois</span><span class="p">),</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include sankey_plotly_elec_bois.html %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Rotex">Rotex<a class="anchor-link" href="#Rotex"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">Ratio_pertes</span> <span class="o">=</span> <span class="mf">2.58</span>
<span class="n">Frac_nucleaire</span><span class="o">=</span><span class="mf">0.65</span>
<span class="n">Frac_ENR_reseau</span><span class="o">=</span><span class="mf">0.25</span>
<span class="n">Frac_gaz</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_ENR_reseau</span><span class="o">-</span><span class="n">Frac_nucleaire</span>

<span class="n">rdt_chaud</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">rdt_insert</span><span class="o">=</span><span class="mf">0.75</span> <span class="c1">#(0.90 sinon)</span>
<span class="n">PV_frac_autoconso</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">nb_pers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Total_conso_bois</span> <span class="o">=</span> <span class="mi">3500</span>
<span class="n">Total_chauff_SdB</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">Total_ECS</span> <span class="o">=</span> <span class="mi">600</span><span class="o">*</span><span class="n">nb_pers</span>
<span class="n">Total_pompe_piscine</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">31</span><span class="o">*</span><span class="mf">0.750</span>
<span class="n">Total_conso_elec</span> <span class="o">=</span> <span class="mi">1100</span><span class="o">*</span><span class="n">nb_pers</span> <span class="o">+</span> <span class="n">Total_chauff_SdB</span> <span class="o">+</span> <span class="n">Total_pompe_piscine</span>

<span class="n">Total_conso_elec_reseau</span> <span class="o">=</span> <span class="n">Total_conso_elec</span><span class="o">*</span><span class="n">PV_frac_autoconso</span>
<span class="n">Part_PAC</span><span class="o">=</span><span class="mi">0</span>
<span class="n">Total_prod_thermique</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">Total_conso_gaz</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span> <span class="o">-</span> <span class="n">Total_prod_thermique</span> <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Part_PAC</span><span class="p">)</span><span class="o">+</span> <span class="n">Total_ECS</span>
<span class="n">Frac_recup_bois</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mi">0</span>

<span class="n">Total_prod_PV</span> <span class="o">=</span> <span class="mi">5900</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_revente_PV</span> <span class="o">=</span> <span class="p">(</span><span class="n">Total_prod_PV</span><span class="o">-</span><span class="n">Total_conso_elec</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">PV_frac_autoconso</span><span class="p">))</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_charge_batterie</span> <span class="o">=</span> <span class="n">Total_prod_PV</span> <span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_decharge_batterie</span> <span class="o">=</span> <span class="n">Total_charge_batterie</span><span class="o">*</span><span class="mf">0.85</span><span class="o">*</span><span class="mi">0</span>


<span class="n">Total_prod_thermique_piscine</span> <span class="o">=</span> <span class="mi">3800</span><span class="o">*</span><span class="mi">0</span>

<span class="n">Total_th_PAC</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span> <span class="p">)</span><span class="o">*</span><span class="n">Part_PAC</span>
<span class="n">sCOP</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="mf">2.5</span>

<span class="n">Total_thermique</span> <span class="o">=</span> <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span> <span class="o">+</span> <span class="n">Total_prod_thermique</span> <span class="o">+</span> <span class="n">Frac_recup_bois</span><span class="o">*</span><span class="n">Total_conso_bois</span> <span class="o">+</span> <span class="n">Total_th_PAC</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
    <span class="n">arrangement</span> <span class="o">=</span> <span class="s2">&quot;snap&quot;</span><span class="p">,</span>
    <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span>
    <span class="n">node</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Non renouvelable&quot;</span><span class="p">,</span>       <span class="c1"># 0</span>
                  <span class="s2">&quot;ENR&quot;</span><span class="p">,</span>                    <span class="c1"># 1</span>
                  <span class="s2">&quot;Nucléaire&quot;</span><span class="p">,</span>              <span class="c1"># 2</span>
                  <span class="s2">&quot;Gaz&quot;</span><span class="p">,</span>                    <span class="c1"># 3</span>
                  <span class="s2">&quot;ENR Réseau&quot;</span><span class="p">,</span>             <span class="c1"># 4</span>
                  <span class="s2">&quot;Photovoltaïque&quot;</span><span class="p">,</span>         <span class="c1"># 5</span>
                  <span class="s2">&quot;Solaire thermique&quot;</span><span class="p">,</span>      <span class="c1"># 6</span>
                  <span class="s2">&quot;Air (PAC)&quot;</span><span class="p">,</span>              <span class="c1"># 7</span>
                  <span class="s2">&quot;Bois&quot;</span><span class="p">,</span>                   <span class="c1"># 8</span>
                  <span class="s2">&quot;Electricité Réseau&quot;</span><span class="p">,</span>     <span class="c1"># 9</span>
                  <span class="s2">&quot;Pertes&quot;</span><span class="p">,</span>                 <span class="c1"># 10</span>
                  <span class="s2">&quot;Electricité domestique&quot;</span><span class="p">,</span> <span class="c1"># 11</span>
                  <span class="s2">&quot;Usage direct&quot;</span><span class="p">,</span>           <span class="c1"># 12</span>
                  <span class="s2">&quot;Batterie&quot;</span><span class="p">,</span>               <span class="c1"># 13</span>
                  <span class="s2">&quot;Revente&quot;</span><span class="p">,</span>                <span class="c1"># 14</span>
                  <span class="s2">&quot;Prod eau chaude&quot;</span><span class="p">,</span>        <span class="c1"># 15</span>
                  <span class="s2">&quot;Chauffage&quot;</span><span class="p">,</span>              <span class="c1"># 16</span>
                  <span class="s2">&quot;ECS&quot;</span><span class="p">,</span>                    <span class="c1"># 17</span>
                  <span class="s2">&quot;Chauffage piscine&quot;</span><span class="p">,</span>      <span class="c1"># 18</span>
                  <span class="s2">&quot;PAC&quot;</span><span class="p">,</span>                    <span class="c1"># 19</span>
                  <span class="s2">&quot;Autre&quot;</span><span class="p">,</span>                  <span class="c1"># 20</span>
                  <span class="s2">&quot;Piscine&quot;</span><span class="p">,</span>          <span class="c1"># 21</span>
                  <span class="s2">&quot;Piscine&quot;</span>                 <span class="c1"># 22</span>
                 <span class="p">],</span>
<span class="c1">#        &quot;x&quot;: [0.2, 0.1, 0.5, 0.7, 0.3, 0.5],</span>
<span class="c1">#        &quot;y&quot;: [0.7, 0.5, 0.2, 0.4, 0.2, 0.3],</span>
        <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">},</span>  <span class="c1"># 10 Pixels</span>
    <span class="n">link</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="mi">2</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span>
                   <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span>
                   <span class="mi">14</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">7</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">21</span>
                  <span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">20</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">21</span><span class="p">,</span>
                   <span class="mi">22</span><span class="p">,</span>
                   <span class="mi">22</span>
                  <span class="p">],</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="o">+</span> <span class="n">Total_conso_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="n">Total_prod_PV</span><span class="p">,</span> <span class="n">Total_prod_thermique</span><span class="o">+</span><span class="n">Total_prod_thermique_piscine</span><span class="p">,</span> <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span> <span class="n">Total_conso_bois</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="c1"># + INJ </span>
                  <span class="n">Total_conso_elec_reseau</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="p">(</span><span class="n">Ratio_pertes</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                  <span class="n">Total_prod_PV</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">*</span><span class="mi">0</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span> <span class="n">Total_charge_batterie</span><span class="p">,</span> <span class="n">Total_revente_PV</span><span class="p">,</span> <span class="c1">###</span>
                  <span class="n">Total_revente_PV</span><span class="p">,</span>
                  <span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="n">Frac_recup_bois</span><span class="p">,</span>
                  <span class="n">Total_thermique</span><span class="o">-</span><span class="n">Total_ECS</span><span class="p">,</span><span class="n">Total_ECS</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_chauff_SdB</span><span class="p">,</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_recup_bois</span><span class="p">),</span>
                  <span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">-</span><span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="o">-</span><span class="n">Total_chauff_SdB</span><span class="o">-</span><span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_charge_batterie</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_chaud</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_insert</span><span class="p">),</span>
                  <span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_pompe_piscine</span><span class="o">*</span><span class="mi">0</span>
                 <span class="p">]</span>
    <span class="p">}))</span>

<span class="n">sankey_plotly_rotex</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Plotly</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">scenarios</span><span class="p">[</span><span class="s1">&#39;Combiné gaz condensation/solaire&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sankey_plotly_rotex</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../_includes/sankey_plotly_rotex.html&#39;</span>
<span class="n">export_plot_fastpages</span><span class="p">(</span><span class="n">pn</span><span class="o">.</span><span class="n">panel</span><span class="p">(</span><span class="n">sankey_plotly_rotex</span><span class="p">),</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include sankey_plotly_rotex.html %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Rotex-gaz-uniquement">Rotex gaz uniquement<a class="anchor-link" href="#Rotex-gaz-uniquement"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">Ratio_pertes</span> <span class="o">=</span> <span class="mf">2.58</span>
<span class="n">Frac_nucleaire</span><span class="o">=</span><span class="mf">0.65</span>
<span class="n">Frac_ENR_reseau</span><span class="o">=</span><span class="mf">0.25</span>
<span class="n">Frac_gaz</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_ENR_reseau</span><span class="o">-</span><span class="n">Frac_nucleaire</span>

<span class="n">rdt_chaud</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">rdt_insert</span><span class="o">=</span><span class="mf">0.75</span> <span class="c1">#(0.90 sinon)</span>
<span class="n">PV_frac_autoconso</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">nb_pers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Total_conso_bois</span> <span class="o">=</span> <span class="mi">3500</span>
<span class="n">Total_chauff_SdB</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">Total_ECS</span> <span class="o">=</span> <span class="mi">600</span><span class="o">*</span><span class="n">nb_pers</span>
<span class="n">Total_pompe_piscine</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">31</span><span class="o">*</span><span class="mf">0.750</span>
<span class="n">Total_conso_elec</span> <span class="o">=</span> <span class="mi">1100</span><span class="o">*</span><span class="n">nb_pers</span> <span class="o">+</span> <span class="n">Total_chauff_SdB</span> <span class="o">+</span> <span class="n">Total_pompe_piscine</span>

<span class="n">Total_conso_elec_reseau</span> <span class="o">=</span> <span class="n">Total_conso_elec</span><span class="o">*</span><span class="n">PV_frac_autoconso</span>
<span class="n">Part_PAC</span><span class="o">=</span><span class="mi">0</span>
<span class="n">Total_prod_thermique</span> <span class="o">=</span> <span class="mi">3000</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_conso_gaz</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span> <span class="o">-</span> <span class="n">Total_prod_thermique</span> <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Part_PAC</span><span class="p">)</span><span class="o">+</span> <span class="n">Total_ECS</span>
<span class="n">Frac_recup_bois</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mi">0</span>

<span class="n">Total_prod_PV</span> <span class="o">=</span> <span class="mi">5900</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_revente_PV</span> <span class="o">=</span> <span class="p">(</span><span class="n">Total_prod_PV</span><span class="o">-</span><span class="n">Total_conso_elec</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">PV_frac_autoconso</span><span class="p">))</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_charge_batterie</span> <span class="o">=</span> <span class="n">Total_prod_PV</span> <span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_decharge_batterie</span> <span class="o">=</span> <span class="n">Total_charge_batterie</span><span class="o">*</span><span class="mf">0.85</span><span class="o">*</span><span class="mi">0</span>


<span class="n">Total_prod_thermique_piscine</span> <span class="o">=</span> <span class="mi">3800</span><span class="o">*</span><span class="mi">0</span>

<span class="n">Total_th_PAC</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span> <span class="p">)</span><span class="o">*</span><span class="n">Part_PAC</span>
<span class="n">sCOP</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="mf">2.5</span>

<span class="n">Total_thermique</span> <span class="o">=</span> <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span> <span class="o">+</span> <span class="n">Total_prod_thermique</span> <span class="o">+</span> <span class="n">Frac_recup_bois</span><span class="o">*</span><span class="n">Total_conso_bois</span> <span class="o">+</span> <span class="n">Total_th_PAC</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
    <span class="n">arrangement</span> <span class="o">=</span> <span class="s2">&quot;snap&quot;</span><span class="p">,</span>
    <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span>
    <span class="n">node</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Non renouvelable&quot;</span><span class="p">,</span>       <span class="c1"># 0</span>
                  <span class="s2">&quot;ENR&quot;</span><span class="p">,</span>                    <span class="c1"># 1</span>
                  <span class="s2">&quot;Nucléaire&quot;</span><span class="p">,</span>              <span class="c1"># 2</span>
                  <span class="s2">&quot;Gaz&quot;</span><span class="p">,</span>                    <span class="c1"># 3</span>
                  <span class="s2">&quot;ENR Réseau&quot;</span><span class="p">,</span>             <span class="c1"># 4</span>
                  <span class="s2">&quot;Photovoltaïque&quot;</span><span class="p">,</span>         <span class="c1"># 5</span>
                  <span class="s2">&quot;Solaire thermique&quot;</span><span class="p">,</span>      <span class="c1"># 6</span>
                  <span class="s2">&quot;Air (PAC)&quot;</span><span class="p">,</span>              <span class="c1"># 7</span>
                  <span class="s2">&quot;Bois&quot;</span><span class="p">,</span>                   <span class="c1"># 8</span>
                  <span class="s2">&quot;Electricité Réseau&quot;</span><span class="p">,</span>     <span class="c1"># 9</span>
                  <span class="s2">&quot;Pertes&quot;</span><span class="p">,</span>                 <span class="c1"># 10</span>
                  <span class="s2">&quot;Electricité domestique&quot;</span><span class="p">,</span> <span class="c1"># 11</span>
                  <span class="s2">&quot;Usage direct&quot;</span><span class="p">,</span>           <span class="c1"># 12</span>
                  <span class="s2">&quot;Batterie&quot;</span><span class="p">,</span>               <span class="c1"># 13</span>
                  <span class="s2">&quot;Revente&quot;</span><span class="p">,</span>                <span class="c1"># 14</span>
                  <span class="s2">&quot;Prod eau chaude&quot;</span><span class="p">,</span>        <span class="c1"># 15</span>
                  <span class="s2">&quot;Chauffage&quot;</span><span class="p">,</span>              <span class="c1"># 16</span>
                  <span class="s2">&quot;ECS&quot;</span><span class="p">,</span>                    <span class="c1"># 17</span>
                  <span class="s2">&quot;Chauffage piscine&quot;</span><span class="p">,</span>      <span class="c1"># 18</span>
                  <span class="s2">&quot;PAC&quot;</span><span class="p">,</span>                    <span class="c1"># 19</span>
                  <span class="s2">&quot;Autre&quot;</span><span class="p">,</span>                  <span class="c1"># 20</span>
                  <span class="s2">&quot;Piscine&quot;</span><span class="p">,</span>          <span class="c1"># 21</span>
                  <span class="s2">&quot;Piscine&quot;</span>                 <span class="c1"># 22</span>
                 <span class="p">],</span>
<span class="c1">#        &quot;x&quot;: [0.2, 0.1, 0.5, 0.7, 0.3, 0.5],</span>
<span class="c1">#        &quot;y&quot;: [0.7, 0.5, 0.2, 0.4, 0.2, 0.3],</span>
        <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">},</span>  <span class="c1"># 10 Pixels</span>
    <span class="n">link</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="mi">2</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span>
                   <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span>
                   <span class="mi">14</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">7</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">21</span>
                  <span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">20</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">21</span><span class="p">,</span>
                   <span class="mi">22</span><span class="p">,</span>
                   <span class="mi">22</span>
                  <span class="p">],</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="o">+</span> <span class="n">Total_conso_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="n">Total_prod_PV</span><span class="p">,</span> <span class="n">Total_prod_thermique</span><span class="o">+</span><span class="n">Total_prod_thermique_piscine</span><span class="p">,</span> <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span> <span class="n">Total_conso_bois</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="c1"># + INJ </span>
                  <span class="n">Total_conso_elec_reseau</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="p">(</span><span class="n">Ratio_pertes</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                  <span class="n">Total_prod_PV</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">*</span><span class="mi">0</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span> <span class="n">Total_charge_batterie</span><span class="p">,</span> <span class="n">Total_revente_PV</span><span class="p">,</span> <span class="c1">###</span>
                  <span class="n">Total_revente_PV</span><span class="p">,</span>
                  <span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="n">Frac_recup_bois</span><span class="p">,</span>
                  <span class="n">Total_thermique</span><span class="o">-</span><span class="n">Total_ECS</span><span class="p">,</span><span class="n">Total_ECS</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_chauff_SdB</span><span class="p">,</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_recup_bois</span><span class="p">),</span>
                  <span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">-</span><span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="o">-</span><span class="n">Total_chauff_SdB</span><span class="o">-</span><span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_charge_batterie</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_chaud</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_insert</span><span class="p">),</span>
                  <span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_pompe_piscine</span><span class="o">*</span><span class="mi">0</span>
                 <span class="p">]</span>
    <span class="p">}))</span>

<span class="n">sankey_plotly_rotex_gaz</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Plotly</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="n">scenarios</span><span class="p">[</span><span class="s1">&#39;Gaz seul&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sankey_plotly_rotex_gaz</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../_includes/sankey_plotly_rotex_gaz.html&#39;</span>
                
<span class="n">export_plot_fastpages</span><span class="p">(</span><span class="n">pn</span><span class="o">.</span><span class="n">panel</span><span class="p">(</span><span class="n">sankey_plotly_rotex_gaz</span><span class="p">),</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include sankey_plotly_rotex_gaz.html %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Rotex-+-piscine">Rotex + piscine<a class="anchor-link" href="#Rotex-+-piscine"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">Ratio_pertes</span> <span class="o">=</span> <span class="mf">2.58</span>
<span class="n">Frac_nucleaire</span><span class="o">=</span><span class="mf">0.65</span>
<span class="n">Frac_ENR_reseau</span><span class="o">=</span><span class="mf">0.25</span>
<span class="n">Frac_gaz</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_ENR_reseau</span><span class="o">-</span><span class="n">Frac_nucleaire</span>

<span class="n">rdt_chaud</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">rdt_insert</span><span class="o">=</span><span class="mf">0.75</span> <span class="c1">#(0.90 sinon)</span>
<span class="n">PV_frac_autoconso</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">nb_pers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Total_conso_bois</span> <span class="o">=</span> <span class="mi">3500</span>
<span class="n">Total_chauff_SdB</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">Total_ECS</span> <span class="o">=</span> <span class="mi">600</span><span class="o">*</span><span class="n">nb_pers</span>
<span class="n">Total_pompe_piscine</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">31</span><span class="o">*</span><span class="mf">0.750</span>
<span class="n">Total_conso_elec</span> <span class="o">=</span> <span class="mi">1100</span><span class="o">*</span><span class="n">nb_pers</span> <span class="o">+</span> <span class="n">Total_chauff_SdB</span>  <span class="o">+</span> <span class="n">Total_pompe_piscine</span>

<span class="n">Total_conso_elec_reseau</span> <span class="o">=</span> <span class="n">Total_conso_elec</span><span class="o">*</span><span class="n">PV_frac_autoconso</span>
<span class="n">Part_PAC</span><span class="o">=</span><span class="mi">0</span>
<span class="n">Total_prod_thermique</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">Total_conso_gaz</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span> <span class="o">-</span> <span class="n">Total_prod_thermique</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Part_PAC</span><span class="p">)</span> <span class="o">+</span> <span class="n">Total_ECS</span>
<span class="n">Frac_recup_bois</span> <span class="o">=</span> <span class="mf">0.3</span><span class="o">*</span><span class="mi">0</span>

<span class="n">Total_prod_PV</span> <span class="o">=</span> <span class="mi">5900</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_revente_PV</span> <span class="o">=</span> <span class="p">(</span><span class="n">Total_prod_PV</span><span class="o">-</span><span class="n">Total_conso_elec</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">PV_frac_autoconso</span><span class="p">))</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_charge_batterie</span> <span class="o">=</span> <span class="n">Total_prod_PV</span> <span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_decharge_batterie</span> <span class="o">=</span> <span class="n">Total_charge_batterie</span><span class="o">*</span><span class="mf">0.85</span><span class="o">*</span><span class="mi">0</span>


<span class="n">Total_prod_thermique_piscine</span> <span class="o">=</span> <span class="mi">3800</span>

<span class="n">Total_th_PAC</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span> <span class="p">)</span><span class="o">*</span><span class="n">Part_PAC</span>
<span class="n">sCOP</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="mf">2.5</span>

<span class="n">Total_thermique</span> <span class="o">=</span> <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span> <span class="o">+</span> <span class="n">Total_prod_thermique</span> <span class="o">+</span> <span class="n">Frac_recup_bois</span><span class="o">*</span><span class="n">Total_conso_bois</span> <span class="o">+</span> <span class="n">Total_th_PAC</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
    <span class="n">arrangement</span> <span class="o">=</span> <span class="s2">&quot;snap&quot;</span><span class="p">,</span>
    <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span>
    <span class="n">node</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Non renouvelable&quot;</span><span class="p">,</span>       <span class="c1"># 0</span>
                  <span class="s2">&quot;ENR&quot;</span><span class="p">,</span>                    <span class="c1"># 1</span>
                  <span class="s2">&quot;Nucléaire&quot;</span><span class="p">,</span>              <span class="c1"># 2</span>
                  <span class="s2">&quot;Gaz&quot;</span><span class="p">,</span>                    <span class="c1"># 3</span>
                  <span class="s2">&quot;ENR Réseau&quot;</span><span class="p">,</span>             <span class="c1"># 4</span>
                  <span class="s2">&quot;Photovoltaïque&quot;</span><span class="p">,</span>         <span class="c1"># 5</span>
                  <span class="s2">&quot;Solaire thermique&quot;</span><span class="p">,</span>      <span class="c1"># 6</span>
                  <span class="s2">&quot;Air (PAC)&quot;</span><span class="p">,</span>              <span class="c1"># 7</span>
                  <span class="s2">&quot;Bois&quot;</span><span class="p">,</span>                   <span class="c1"># 8</span>
                  <span class="s2">&quot;Electricité Réseau&quot;</span><span class="p">,</span>     <span class="c1"># 9</span>
                  <span class="s2">&quot;Pertes&quot;</span><span class="p">,</span>                 <span class="c1"># 10</span>
                  <span class="s2">&quot;Electricité domestique&quot;</span><span class="p">,</span> <span class="c1"># 11</span>
                  <span class="s2">&quot;Usage direct&quot;</span><span class="p">,</span>           <span class="c1"># 12</span>
                  <span class="s2">&quot;Batterie&quot;</span><span class="p">,</span>               <span class="c1"># 13</span>
                  <span class="s2">&quot;Revente&quot;</span><span class="p">,</span>                <span class="c1"># 14</span>
                  <span class="s2">&quot;Prod eau chaude&quot;</span><span class="p">,</span>        <span class="c1"># 15</span>
                  <span class="s2">&quot;Chauffage&quot;</span><span class="p">,</span>              <span class="c1"># 16</span>
                  <span class="s2">&quot;ECS&quot;</span><span class="p">,</span>                    <span class="c1"># 17</span>
                  <span class="s2">&quot;Chauffage piscine&quot;</span><span class="p">,</span>      <span class="c1"># 18</span>
                  <span class="s2">&quot;PAC&quot;</span><span class="p">,</span>                    <span class="c1"># 19</span>
                  <span class="s2">&quot;Autre&quot;</span><span class="p">,</span>                  <span class="c1"># 20</span>
                  <span class="s2">&quot;Pompe Piscine&quot;</span><span class="p">,</span>          <span class="c1"># 21</span>
                  <span class="s2">&quot;Piscine&quot;</span>                 <span class="c1"># 22</span>
                 <span class="p">],</span>
<span class="c1">#        &quot;x&quot;: [0.2, 0.1, 0.5, 0.7, 0.3, 0.5],</span>
<span class="c1">#        &quot;y&quot;: [0.7, 0.5, 0.2, 0.4, 0.2, 0.3],</span>
        <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">40</span><span class="p">},</span>  <span class="c1"># 10 Pixels</span>
    <span class="n">link</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="mi">2</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span>
                   <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span>
                   <span class="mi">14</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">7</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">21</span>
                  <span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">20</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">21</span><span class="p">,</span>
                   <span class="mi">22</span><span class="p">,</span>
                   <span class="mi">22</span>
                  <span class="p">],</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="o">+</span> <span class="n">Total_conso_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="n">Total_prod_PV</span><span class="p">,</span> <span class="n">Total_prod_thermique</span><span class="o">+</span><span class="n">Total_prod_thermique_piscine</span><span class="p">,</span> <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span> <span class="n">Total_conso_bois</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="c1"># + INJ </span>
                  <span class="n">Total_conso_elec_reseau</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="p">(</span><span class="n">Ratio_pertes</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                  <span class="n">Total_prod_PV</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">*</span><span class="mi">0</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span> <span class="n">Total_charge_batterie</span><span class="p">,</span> <span class="n">Total_revente_PV</span><span class="p">,</span> <span class="c1">###</span>
                  <span class="n">Total_revente_PV</span><span class="p">,</span>
                  <span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="n">Frac_recup_bois</span><span class="p">,</span>
                  <span class="n">Total_thermique</span><span class="o">-</span><span class="n">Total_ECS</span><span class="p">,</span><span class="n">Total_ECS</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_chauff_SdB</span><span class="p">,</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_recup_bois</span><span class="p">),</span>
                  <span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">-</span><span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="o">-</span><span class="n">Total_chauff_SdB</span><span class="o">-</span><span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_charge_batterie</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_chaud</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_insert</span><span class="p">),</span>
                  <span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_pompe_piscine</span>
                 <span class="p">]</span>
    <span class="p">}))</span>

<span class="n">sankey_plotly_rotex_piscine</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Plotly</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">scenarios</span><span class="p">[</span><span class="s1">&#39;Combiné gaz condensation/solaire &amp; Piscine&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sankey_plotly_rotex_piscine</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../_includes/sankey_plotly_rotex_piscine.html&#39;</span>
                
<span class="n">export_plot_fastpages</span><span class="p">(</span><span class="n">pn</span><span class="o">.</span><span class="n">panel</span><span class="p">(</span><span class="n">sankey_plotly_rotex_piscine</span><span class="p">),</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include sankey_plotly_rotex_piscine.html %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Rotex-+-piscine-+-bouilleur">Rotex + piscine + bouilleur<a class="anchor-link" href="#Rotex-+-piscine-+-bouilleur"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">Ratio_pertes</span> <span class="o">=</span> <span class="mf">2.58</span>
<span class="n">Frac_nucleaire</span><span class="o">=</span><span class="mf">0.65</span>
<span class="n">Frac_ENR_reseau</span><span class="o">=</span><span class="mf">0.25</span>
<span class="n">Frac_gaz</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_ENR_reseau</span><span class="o">-</span><span class="n">Frac_nucleaire</span>

<span class="n">rdt_chaud</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">rdt_insert</span><span class="o">=</span><span class="mf">0.90</span>
<span class="n">PV_frac_autoconso</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">nb_pers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Total_conso_bois</span> <span class="o">=</span> <span class="mi">3500</span>
<span class="n">Total_chauff_SdB</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">Total_ECS</span> <span class="o">=</span> <span class="mi">600</span><span class="o">*</span><span class="n">nb_pers</span>
<span class="n">Total_pompe_piscine</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">31</span><span class="o">*</span><span class="mf">0.750</span>
<span class="n">Total_conso_elec</span> <span class="o">=</span> <span class="mi">1100</span><span class="o">*</span><span class="n">nb_pers</span> <span class="o">+</span> <span class="n">Total_chauff_SdB</span> <span class="o">+</span> <span class="n">Total_pompe_piscine</span>

<span class="n">Total_conso_elec_reseau</span> <span class="o">=</span> <span class="n">Total_conso_elec</span><span class="o">*</span><span class="n">PV_frac_autoconso</span>
<span class="n">Part_PAC</span><span class="o">=</span><span class="mi">0</span>
<span class="n">Total_prod_thermique</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">Total_conso_gaz</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span> <span class="o">-</span> <span class="n">Total_prod_thermique</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Part_PAC</span><span class="p">)</span><span class="o">+</span> <span class="n">Total_ECS</span>
<span class="n">Frac_recup_bois</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="n">Total_prod_PV</span> <span class="o">=</span> <span class="mi">5900</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_revente_PV</span> <span class="o">=</span> <span class="p">(</span><span class="n">Total_prod_PV</span><span class="o">-</span><span class="n">Total_conso_elec</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">PV_frac_autoconso</span><span class="p">))</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_charge_batterie</span> <span class="o">=</span> <span class="n">Total_prod_PV</span> <span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_decharge_batterie</span> <span class="o">=</span> <span class="n">Total_charge_batterie</span><span class="o">*</span><span class="mf">0.85</span><span class="o">*</span><span class="mi">0</span>

<span class="n">Total_prod_thermique_piscine</span> <span class="o">=</span> <span class="mi">3800</span>

<span class="n">Total_th_PAC</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span><span class="p">)</span><span class="o">*</span><span class="n">Part_PAC</span>
<span class="n">sCOP</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="mf">2.5</span>

<span class="n">Total_thermique</span> <span class="o">=</span> <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span> <span class="o">+</span> <span class="n">Total_prod_thermique</span> <span class="o">+</span> <span class="n">Frac_recup_bois</span><span class="o">*</span><span class="n">Total_conso_bois</span> <span class="o">+</span> <span class="n">Total_th_PAC</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
    <span class="n">arrangement</span> <span class="o">=</span> <span class="s2">&quot;snap&quot;</span><span class="p">,</span>
    <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span>
    <span class="n">node</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Non renouvelable&quot;</span><span class="p">,</span>       <span class="c1"># 0</span>
                  <span class="s2">&quot;ENR&quot;</span><span class="p">,</span>                    <span class="c1"># 1</span>
                  <span class="s2">&quot;Nucléaire&quot;</span><span class="p">,</span>              <span class="c1"># 2</span>
                  <span class="s2">&quot;Gaz&quot;</span><span class="p">,</span>                    <span class="c1"># 3</span>
                  <span class="s2">&quot;ENR Réseau&quot;</span><span class="p">,</span>             <span class="c1"># 4</span>
                  <span class="s2">&quot;Photovoltaïque&quot;</span><span class="p">,</span>         <span class="c1"># 5</span>
                  <span class="s2">&quot;Solaire thermique&quot;</span><span class="p">,</span>      <span class="c1"># 6</span>
                  <span class="s2">&quot;Air (PAC)&quot;</span><span class="p">,</span>              <span class="c1"># 7</span>
                  <span class="s2">&quot;Bois&quot;</span><span class="p">,</span>                   <span class="c1"># 8</span>
                  <span class="s2">&quot;Electricité Réseau&quot;</span><span class="p">,</span>     <span class="c1"># 9</span>
                  <span class="s2">&quot;Pertes&quot;</span><span class="p">,</span>                 <span class="c1"># 10</span>
                  <span class="s2">&quot;Electricité domestique&quot;</span><span class="p">,</span> <span class="c1"># 11</span>
                  <span class="s2">&quot;Usage direct&quot;</span><span class="p">,</span>           <span class="c1"># 12</span>
                  <span class="s2">&quot;Batterie&quot;</span><span class="p">,</span>               <span class="c1"># 13</span>
                  <span class="s2">&quot;Revente&quot;</span><span class="p">,</span>                <span class="c1"># 14</span>
                  <span class="s2">&quot;Prod eau chaude&quot;</span><span class="p">,</span>        <span class="c1"># 15</span>
                  <span class="s2">&quot;Chauffage&quot;</span><span class="p">,</span>              <span class="c1"># 16</span>
                  <span class="s2">&quot;ECS&quot;</span><span class="p">,</span>                    <span class="c1"># 17</span>
                  <span class="s2">&quot;Chauffage piscine&quot;</span><span class="p">,</span>      <span class="c1"># 18</span>
                  <span class="s2">&quot;PAC&quot;</span><span class="p">,</span>                    <span class="c1"># 19</span>
                  <span class="s2">&quot;Autre&quot;</span><span class="p">,</span>                  <span class="c1"># 20</span>
                  <span class="s2">&quot;Pompe Piscine&quot;</span><span class="p">,</span>          <span class="c1"># 21</span>
                  <span class="s2">&quot;Piscine&quot;</span>                 <span class="c1"># 22</span>
                 <span class="p">],</span>
<span class="c1">#        &quot;x&quot;: [0.2, 0.1, 0.5, 0.7, 0.3, 0.5],</span>
<span class="c1">#        &quot;y&quot;: [0.7, 0.5, 0.2, 0.4, 0.2, 0.3],</span>
        <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">40</span><span class="p">},</span>  <span class="c1"># 10 Pixels</span>
    <span class="n">link</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="mi">2</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span>
                   <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span>
                   <span class="mi">14</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">7</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">21</span>
                  <span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">20</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">21</span><span class="p">,</span>
                   <span class="mi">22</span><span class="p">,</span>
                   <span class="mi">22</span>
                  <span class="p">],</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="o">+</span> <span class="n">Total_conso_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="n">Total_prod_PV</span><span class="p">,</span> <span class="n">Total_prod_thermique</span><span class="o">+</span><span class="n">Total_prod_thermique_piscine</span><span class="p">,</span> <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span> <span class="n">Total_conso_bois</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="c1"># + INJ </span>
                  <span class="n">Total_conso_elec_reseau</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="p">(</span><span class="n">Ratio_pertes</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                  <span class="n">Total_prod_PV</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">*</span><span class="mi">0</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span> <span class="n">Total_charge_batterie</span><span class="p">,</span> <span class="n">Total_revente_PV</span><span class="p">,</span> <span class="c1">###</span>
                  <span class="n">Total_revente_PV</span><span class="p">,</span>
                  <span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="n">Frac_recup_bois</span><span class="p">,</span>
                  <span class="n">Total_thermique</span><span class="o">-</span><span class="n">Total_ECS</span><span class="p">,</span><span class="n">Total_ECS</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_chauff_SdB</span><span class="p">,</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_recup_bois</span><span class="p">),</span>
                  <span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">-</span><span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="o">-</span><span class="n">Total_chauff_SdB</span><span class="o">-</span><span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_charge_batterie</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_chaud</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_insert</span><span class="p">),</span>
                  <span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_pompe_piscine</span>
                 <span class="p">]</span>
    <span class="p">}))</span>

<span class="n">sankey_plotly_rotex_piscine_builleur</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Plotly</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">scenarios</span><span class="p">[</span><span class="s1">&#39;Combiné gaz condensation/solaire &amp; Piscine &amp; Bouilleur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sankey_plotly_rotex_piscine_builleur</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../_includes/sankey_plotly_rotex_piscine_builleur.html&#39;</span>
                
<span class="n">export_plot_fastpages</span><span class="p">(</span><span class="n">pn</span><span class="o">.</span><span class="n">panel</span><span class="p">(</span><span class="n">sankey_plotly_rotex_piscine_builleur</span><span class="p">),</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include sankey_plotly_rotex_piscine_builleur.html %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Rotex-+-piscine-+-bouilleur-+-PAC">Rotex + piscine + bouilleur + PAC<a class="anchor-link" href="#Rotex-+-piscine-+-bouilleur-+-PAC"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">Ratio_pertes</span> <span class="o">=</span> <span class="mf">2.58</span>
<span class="n">Frac_nucleaire</span><span class="o">=</span><span class="mf">0.65</span>
<span class="n">Frac_ENR_reseau</span><span class="o">=</span><span class="mf">0.25</span>
<span class="n">Frac_gaz</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_ENR_reseau</span><span class="o">-</span><span class="n">Frac_nucleaire</span>

<span class="n">rdt_chaud</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">rdt_insert</span><span class="o">=</span><span class="mf">0.90</span>
<span class="n">PV_frac_autoconso</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">nb_pers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Total_conso_bois</span> <span class="o">=</span> <span class="mi">3500</span>
<span class="n">Total_chauff_SdB</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">Total_ECS</span> <span class="o">=</span> <span class="mi">600</span><span class="o">*</span><span class="n">nb_pers</span>
<span class="n">Total_pompe_piscine</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">31</span><span class="o">*</span><span class="mf">0.750</span>

<span class="n">alpha</span><span class="o">=</span><span class="mf">0.77</span>


<span class="n">Part_PAC</span><span class="o">=</span><span class="mf">0.87</span>
<span class="n">Total_prod_thermique</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">Total_conso_gaz</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span> <span class="o">-</span> <span class="n">Total_prod_thermique</span><span class="o">+</span> <span class="n">Total_ECS</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Part_PAC</span><span class="p">)</span><span class="o">*</span><span class="n">alpha</span>  
<span class="n">Frac_recup_bois</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="n">Total_th_PAC</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span><span class="o">+</span> <span class="n">Total_ECS</span><span class="p">)</span><span class="o">*</span><span class="n">Part_PAC</span><span class="o">*</span><span class="n">alpha</span>
<span class="n">sCOP</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="mf">2.5</span>

<span class="n">P_elec_PAC</span> <span class="o">=</span> <span class="n">Total_th_PAC</span> <span class="o">/</span> <span class="n">sCOP</span>

<span class="n">Total_conso_elec</span> <span class="o">=</span> <span class="mi">1100</span><span class="o">*</span><span class="n">nb_pers</span> <span class="o">+</span> <span class="n">Total_chauff_SdB</span> <span class="o">+</span> <span class="n">Total_pompe_piscine</span> <span class="o">+</span> <span class="n">P_elec_PAC</span>
<span class="n">Total_conso_elec_reseau</span> <span class="o">=</span> <span class="n">Total_conso_elec</span><span class="o">*</span><span class="n">PV_frac_autoconso</span>

<span class="n">Total_prod_PV</span> <span class="o">=</span> <span class="mi">5900</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_revente_PV</span> <span class="o">=</span> <span class="p">(</span><span class="n">Total_prod_PV</span><span class="o">-</span><span class="n">Total_conso_elec</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">PV_frac_autoconso</span><span class="p">))</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_charge_batterie</span> <span class="o">=</span> <span class="n">Total_prod_PV</span> <span class="o">*</span><span class="mf">0.3</span><span class="o">*</span><span class="mi">0</span>
<span class="n">Total_decharge_batterie</span> <span class="o">=</span> <span class="n">Total_charge_batterie</span><span class="o">*</span><span class="mf">0.85</span><span class="o">*</span><span class="mi">0</span>


<span class="n">Total_prod_thermique_piscine</span> <span class="o">=</span> <span class="mi">3800</span>



<span class="n">Total_thermique</span> <span class="o">=</span> <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span> <span class="o">+</span> <span class="n">Total_prod_thermique</span> <span class="o">+</span> <span class="n">Frac_recup_bois</span><span class="o">*</span><span class="n">Total_conso_bois</span> <span class="o">+</span> <span class="n">Total_th_PAC</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
    <span class="n">arrangement</span> <span class="o">=</span> <span class="s2">&quot;snap&quot;</span><span class="p">,</span>
    <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span>
    <span class="n">node</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Non renouvelable&quot;</span><span class="p">,</span>       <span class="c1"># 0</span>
                  <span class="s2">&quot;ENR&quot;</span><span class="p">,</span>                    <span class="c1"># 1</span>
                  <span class="s2">&quot;Nucléaire&quot;</span><span class="p">,</span>              <span class="c1"># 2</span>
                  <span class="s2">&quot;Gaz&quot;</span><span class="p">,</span>                    <span class="c1"># 3</span>
                  <span class="s2">&quot;ENR Réseau&quot;</span><span class="p">,</span>             <span class="c1"># 4</span>
                  <span class="s2">&quot;Photovoltaïque&quot;</span><span class="p">,</span>         <span class="c1"># 5</span>
                  <span class="s2">&quot;Solaire thermique&quot;</span><span class="p">,</span>      <span class="c1"># 6</span>
                  <span class="s2">&quot;Air (PAC)&quot;</span><span class="p">,</span>              <span class="c1"># 7</span>
                  <span class="s2">&quot;Bois&quot;</span><span class="p">,</span>                   <span class="c1"># 8</span>
                  <span class="s2">&quot;Electricité Réseau&quot;</span><span class="p">,</span>     <span class="c1"># 9</span>
                  <span class="s2">&quot;Pertes&quot;</span><span class="p">,</span>                 <span class="c1"># 10</span>
                  <span class="s2">&quot;Electricité domestique&quot;</span><span class="p">,</span> <span class="c1"># 11</span>
                  <span class="s2">&quot;Usage direct&quot;</span><span class="p">,</span>           <span class="c1"># 12</span>
                  <span class="s2">&quot;Batterie&quot;</span><span class="p">,</span>               <span class="c1"># 13</span>
                  <span class="s2">&quot;Revente&quot;</span><span class="p">,</span>                <span class="c1"># 14</span>
                  <span class="s2">&quot;Prod eau chaude&quot;</span><span class="p">,</span>        <span class="c1"># 15</span>
                  <span class="s2">&quot;Chauffage&quot;</span><span class="p">,</span>              <span class="c1"># 16</span>
                  <span class="s2">&quot;ECS&quot;</span><span class="p">,</span>                    <span class="c1"># 17</span>
                  <span class="s2">&quot;Chauffage piscine&quot;</span><span class="p">,</span>      <span class="c1"># 18</span>
                  <span class="s2">&quot;PAC&quot;</span><span class="p">,</span>                    <span class="c1"># 19</span>
                  <span class="s2">&quot;Autre&quot;</span><span class="p">,</span>                  <span class="c1"># 20</span>
                  <span class="s2">&quot;Pompe Piscine&quot;</span><span class="p">,</span>          <span class="c1"># 21</span>
                  <span class="s2">&quot;Piscine&quot;</span>                 <span class="c1"># 22</span>
                 <span class="p">],</span>
<span class="c1">#        &quot;x&quot;: [0.2, 0.1, 0.5, 0.7, 0.3, 0.5],</span>
<span class="c1">#        &quot;y&quot;: [0.7, 0.5, 0.2, 0.4, 0.2, 0.3],</span>
        <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">40</span><span class="p">},</span>  <span class="c1"># 10 Pixels</span>
    <span class="n">link</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="mi">2</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span>
                   <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span>
                   <span class="mi">14</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">7</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">21</span>
                  <span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">20</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">21</span><span class="p">,</span>
                   <span class="mi">22</span><span class="p">,</span>
                   <span class="mi">22</span>
                  <span class="p">],</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="o">+</span> <span class="n">Total_conso_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="n">Total_prod_PV</span><span class="p">,</span> <span class="n">Total_prod_thermique</span><span class="o">+</span><span class="n">Total_prod_thermique_piscine</span><span class="p">,</span> <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span> <span class="n">Total_conso_bois</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="c1"># + INJ </span>
                  <span class="n">Total_conso_elec_reseau</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="p">(</span><span class="n">Ratio_pertes</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                  <span class="n">Total_prod_PV</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">*</span><span class="mi">0</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span> <span class="n">Total_charge_batterie</span><span class="p">,</span> <span class="n">Total_revente_PV</span><span class="p">,</span> <span class="c1">###</span>
                  <span class="n">Total_revente_PV</span><span class="p">,</span>
                  <span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="n">Frac_recup_bois</span><span class="p">,</span>
                  <span class="n">Total_thermique</span><span class="o">-</span><span class="n">Total_ECS</span><span class="p">,</span><span class="n">Total_ECS</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_chauff_SdB</span><span class="p">,</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_recup_bois</span><span class="p">),</span>
                  <span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">-</span><span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="o">-</span><span class="n">Total_chauff_SdB</span><span class="o">-</span><span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_charge_batterie</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_chaud</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_insert</span><span class="p">),</span>
                  <span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_pompe_piscine</span>
                 <span class="p">]</span>
    <span class="p">}))</span>

<span class="n">sankey_plotly_rotex_piscine_builleur_pac</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Plotly</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">scenarios</span><span class="p">[</span><span class="s1">&#39;Combiné gaz condensation/solaire &amp; Piscine &amp; Bouilleur &amp; PAC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sankey_plotly_rotex_piscine_builleur_pac</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../_includes/sankey_plotly_rotex_piscine_builleur_pac.html&#39;</span>
                
<span class="n">export_plot_fastpages</span><span class="p">(</span><span class="n">pn</span><span class="o">.</span><span class="n">panel</span><span class="p">(</span><span class="n">sankey_plotly_rotex_piscine_builleur_pac</span><span class="p">),</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include sankey_plotly_rotex_piscine_builleur_pac.html %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Rotex-+-piscine-+-bouilleur-+-PAC-+-PV">Rotex + piscine + bouilleur + PAC + PV<a class="anchor-link" href="#Rotex-+-piscine-+-bouilleur-+-PAC-+-PV"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">Ratio_pertes</span> <span class="o">=</span> <span class="mf">2.58</span>
<span class="n">Frac_nucleaire</span><span class="o">=</span><span class="mf">0.65</span>
<span class="n">Frac_ENR_reseau</span><span class="o">=</span><span class="mf">0.25</span>
<span class="n">Frac_gaz</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_ENR_reseau</span><span class="o">-</span><span class="n">Frac_nucleaire</span>

<span class="n">rdt_chaud</span><span class="o">=</span><span class="mf">0.95</span>
<span class="n">rdt_insert</span><span class="o">=</span><span class="mf">0.90</span>
<span class="n">PV_frac_autoconso</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="n">nb_pers</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">Total_conso_bois</span> <span class="o">=</span> <span class="mi">3500</span>
<span class="n">Total_chauff_SdB</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">Total_ECS</span> <span class="o">=</span> <span class="mi">600</span><span class="o">*</span><span class="n">nb_pers</span>
<span class="n">Total_pompe_piscine</span> <span class="o">=</span> <span class="mi">6</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">31</span><span class="o">*</span><span class="mf">0.750</span>

<span class="n">alpha</span><span class="o">=</span><span class="mf">0.77</span>


<span class="n">Part_PAC</span><span class="o">=</span><span class="mf">0.87</span>
<span class="n">Total_prod_thermique</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">Total_conso_gaz</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span> <span class="o">-</span> <span class="n">Total_prod_thermique</span><span class="o">+</span> <span class="n">Total_ECS</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Part_PAC</span><span class="p">)</span><span class="o">*</span><span class="n">alpha</span>  
<span class="n">Frac_recup_bois</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="n">Total_th_PAC</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15200</span> <span class="o">-</span> <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span> <span class="o">-</span> <span class="n">Total_chauff_SdB</span><span class="o">+</span> <span class="n">Total_ECS</span><span class="p">)</span><span class="o">*</span><span class="n">Part_PAC</span><span class="o">*</span><span class="n">alpha</span>
<span class="n">sCOP</span> <span class="o">=</span> <span class="mf">1.8</span><span class="o">*</span><span class="mf">2.5</span>

<span class="n">P_elec_PAC</span> <span class="o">=</span> <span class="n">Total_th_PAC</span> <span class="o">/</span> <span class="n">sCOP</span>

<span class="n">Total_conso_elec</span> <span class="o">=</span> <span class="mi">1100</span><span class="o">*</span><span class="n">nb_pers</span> <span class="o">+</span> <span class="n">Total_chauff_SdB</span> <span class="o">+</span> <span class="n">Total_pompe_piscine</span> <span class="o">+</span> <span class="n">P_elec_PAC</span>

<span class="n">Total_prod_PV</span> <span class="o">=</span> <span class="mi">5900</span>
<span class="n">Total_revente_PV</span> <span class="o">=</span> <span class="p">(</span><span class="n">Total_prod_PV</span><span class="o">-</span><span class="n">Total_conso_elec</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">PV_frac_autoconso</span><span class="p">))</span>
<span class="n">Total_charge_batterie</span> <span class="o">=</span> <span class="n">Total_prod_PV</span> <span class="o">*</span><span class="mf">0.3</span>
<span class="n">Total_decharge_batterie</span> <span class="o">=</span> <span class="n">Total_charge_batterie</span><span class="o">*</span><span class="mf">0.85</span>

<span class="n">Total_conso_elec_reseau</span> <span class="o">=</span> <span class="mi">2140</span> <span class="c1">#Total_conso_elec*PV_frac_autoconso</span>

<span class="n">Total_prod_thermique_piscine</span> <span class="o">=</span> <span class="mi">3800</span>

<span class="n">Total_thermique</span> <span class="o">=</span> <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span> <span class="o">+</span> <span class="n">Total_prod_thermique</span> <span class="o">+</span> <span class="n">Frac_recup_bois</span><span class="o">*</span><span class="n">Total_conso_bois</span> <span class="o">+</span> <span class="n">Total_th_PAC</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
    <span class="n">arrangement</span> <span class="o">=</span> <span class="s2">&quot;snap&quot;</span><span class="p">,</span>
    <span class="n">textfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">25</span><span class="p">),</span>
    <span class="n">node</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Non renouvelable&quot;</span><span class="p">,</span>       <span class="c1"># 0</span>
                  <span class="s2">&quot;ENR&quot;</span><span class="p">,</span>                    <span class="c1"># 1</span>
                  <span class="s2">&quot;Nucléaire&quot;</span><span class="p">,</span>              <span class="c1"># 2</span>
                  <span class="s2">&quot;Gaz&quot;</span><span class="p">,</span>                    <span class="c1"># 3</span>
                  <span class="s2">&quot;ENR Réseau&quot;</span><span class="p">,</span>             <span class="c1"># 4</span>
                  <span class="s2">&quot;Photovoltaïque&quot;</span><span class="p">,</span>         <span class="c1"># 5</span>
                  <span class="s2">&quot;Solaire thermique&quot;</span><span class="p">,</span>      <span class="c1"># 6</span>
                  <span class="s2">&quot;Air (PAC)&quot;</span><span class="p">,</span>              <span class="c1"># 7</span>
                  <span class="s2">&quot;Bois&quot;</span><span class="p">,</span>                   <span class="c1"># 8</span>
                  <span class="s2">&quot;Electricité Réseau&quot;</span><span class="p">,</span>     <span class="c1"># 9</span>
                  <span class="s2">&quot;Pertes&quot;</span><span class="p">,</span>                 <span class="c1"># 10</span>
                  <span class="s2">&quot;Electricité domestique&quot;</span><span class="p">,</span> <span class="c1"># 11</span>
                  <span class="s2">&quot;Usage direct&quot;</span><span class="p">,</span>           <span class="c1"># 12</span>
                  <span class="s2">&quot;Batterie&quot;</span><span class="p">,</span>               <span class="c1"># 13</span>
                  <span class="s2">&quot;Revente&quot;</span><span class="p">,</span>                <span class="c1"># 14</span>
                  <span class="s2">&quot;Prod eau chaude&quot;</span><span class="p">,</span>        <span class="c1"># 15</span>
                  <span class="s2">&quot;Chauffage&quot;</span><span class="p">,</span>              <span class="c1"># 16</span>
                  <span class="s2">&quot;ECS&quot;</span><span class="p">,</span>                    <span class="c1"># 17</span>
                  <span class="s2">&quot;Chauffage piscine&quot;</span><span class="p">,</span>      <span class="c1"># 18</span>
                  <span class="s2">&quot;PAC&quot;</span><span class="p">,</span>                    <span class="c1"># 19</span>
                  <span class="s2">&quot;Autre&quot;</span><span class="p">,</span>                  <span class="c1"># 20</span>
                  <span class="s2">&quot;Pompe piscine&quot;</span><span class="p">,</span>          <span class="c1"># 21</span>
                  <span class="s2">&quot;Piscine&quot;</span>                 <span class="c1"># 22</span>
                 <span class="p">],</span>
<span class="c1">#        &quot;x&quot;: [0.2, 0.1, 0.5, 0.7, 0.3, 0.5],</span>
<span class="c1">#        &quot;y&quot;: [0.7, 0.5, 0.2, 0.4, 0.2, 0.3],</span>
        <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">20</span><span class="p">},</span>  <span class="c1"># 10 Pixels</span>
    <span class="n">link</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                   <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                   <span class="mi">2</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span>
                   <span class="mi">5</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span>
                   <span class="mi">14</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">7</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span>
                   <span class="mi">6</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">13</span><span class="p">,</span>
                   <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">21</span>
                  <span class="p">],</span>
        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">9</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span>
                   <span class="mi">11</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span>
                   <span class="mi">4</span><span class="p">,</span>
                   <span class="mi">12</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">16</span><span class="p">,</span>
                   <span class="mi">19</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span>
                   <span class="mi">20</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">10</span><span class="p">,</span>
                   <span class="mi">21</span><span class="p">,</span>
                   <span class="mi">22</span><span class="p">,</span>
                   <span class="mi">22</span>
                  <span class="p">],</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="o">+</span> <span class="n">Total_conso_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="n">Total_prod_PV</span><span class="p">,</span> <span class="n">Total_prod_thermique</span><span class="o">+</span><span class="n">Total_prod_thermique_piscine</span><span class="p">,</span> <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span> <span class="n">Total_conso_bois</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_nucleaire</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_gaz</span><span class="p">,</span>
                  <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="n">Ratio_pertes</span><span class="o">*</span><span class="n">Frac_ENR_reseau</span><span class="p">,</span> <span class="c1"># + INJ </span>
                  <span class="n">Total_conso_elec_reseau</span><span class="p">,</span> <span class="n">Total_conso_elec_reseau</span><span class="o">*</span><span class="p">(</span><span class="n">Ratio_pertes</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                  <span class="n">Total_prod_PV</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span> <span class="n">Total_charge_batterie</span><span class="p">,</span> <span class="n">Total_revente_PV</span><span class="p">,</span> <span class="c1">###</span>
                  <span class="n">Total_revente_PV</span><span class="p">,</span>
                  <span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="n">rdt_chaud</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sCOP</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="n">Frac_recup_bois</span><span class="p">,</span>
                  <span class="n">Total_thermique</span><span class="o">-</span><span class="n">Total_ECS</span><span class="p">,</span><span class="n">Total_ECS</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_chauff_SdB</span><span class="p">,</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="n">rdt_insert</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Frac_recup_bois</span><span class="p">),</span>
                  <span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="p">,</span>
                  <span class="n">Total_th_PAC</span><span class="p">,</span>
                  <span class="n">Total_conso_elec</span><span class="o">-</span><span class="n">Total_th_PAC</span><span class="o">/</span><span class="n">sCOP</span><span class="o">-</span><span class="n">Total_chauff_SdB</span><span class="o">-</span><span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_charge_batterie</span><span class="o">-</span><span class="n">Total_decharge_batterie</span><span class="p">,</span>
                  <span class="n">Total_conso_gaz</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_chaud</span><span class="p">),</span>
                  <span class="n">Total_conso_bois</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rdt_insert</span><span class="p">),</span>
                  <span class="n">Total_pompe_piscine</span><span class="p">,</span>
                  <span class="n">Total_prod_thermique_piscine</span><span class="p">,</span>
                  <span class="n">Total_pompe_piscine</span>
                 <span class="p">]</span>
    <span class="p">}))</span>

<span class="n">sankey_plotly_rotex_piscine_builleur_pac_pv</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">pane</span><span class="o">.</span><span class="n">Plotly</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="n">scenarios</span><span class="p">[</span><span class="s1">&#39;Combiné gaz condensation/solaire &amp; Piscine &amp; Bouilleur &amp; PAC &amp; PV&#39;</span> <span class="p">]</span> <span class="o">=</span> <span class="n">sankey_plotly_rotex_piscine_builleur_pac_pv</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;../_includes/sankey_plotly_rotex_piscine_builleur_pac_pv.html&#39;</span>
                
<span class="n">export_plot_fastpages</span><span class="p">(</span><span class="n">pn</span><span class="o">.</span><span class="n">panel</span><span class="p">(</span><span class="n">sankey_plotly_rotex_piscine_builleur_pac_pv</span><span class="p">),</span> <span class="n">filename</span><span class="p">)</span>

<span class="n">sankey_plotly_rotex_piscine_builleur_pac_pv</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div id='1139'>





  <div class="bk-root" id="25d25eb4-0259-45de-b0af-00afb52dd913" data-root-id="1139"></div>
</div>
<script type="application/javascript">(function(root) {
  function embed_document(root) {
    var docs_json = {"22d39d6d-fbad-43b4-93d8-c532833995f0":{"defs":[],"roots":{"references":[{"attributes":{},"id":"1140","type":"Selection"},{"attributes":{"data":{},"selected":{"id":"1140"},"selection_policy":{"id":"1141"}},"id":"1138","type":"ColumnDataSource"},{"attributes":{},"id":"1141","type":"UnionRenderers"},{"attributes":{"data":[{"arrangement":"snap","link":{"source":[0,0,1,1,1,1,1,2,3,4,9,9,5,11,11,11,14,13,3,6,7,8,15,15,6,12,8,12,19,12,13,3,8,12,18,21],"target":[2,3,4,5,6,7,8,9,9,9,11,10,11,12,13,14,4,12,15,15,19,15,16,17,18,16,16,19,15,20,10,10,10,21,22,22],"value":[3588.78,1618.185,1380.3,5900,6800,7112.1050000000005,3500,3588.78,552.1199999999999,1380.3,2140,3381.2000000000003,5900,4725.03,1770.0,1539.3290000000006,1539.3290000000006,1504.5,1012.76175,3000,7112.1050000000005,945.0,12406.89675,1800,3800,200,2205.0,2032.03,9144.135,3300.0,265.5,53.30325000000005,349.99999999999994,697.5,3800,697.5]},"node":{"label":["Non renouvelable","ENR","Nucl\u00e9aire","Gaz","ENR R\u00e9seau","Photovolta\u00efque","Solaire thermique","Air (PAC)","Bois","Electricit\u00e9 R\u00e9seau","Pertes","Electricit\u00e9 domestique","Usage direct","Batterie","Revente","Prod eau chaude","Chauffage","ECS","Chauffage piscine","PAC","Autre","Pompe piscine","Piscine"],"pad":20},"textfont":{"color":"black","size":25},"type":"sankey"}],"data_sources":[{"id":"1138"}],"layout":{"template":{"data":{"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5}},"type":"bar"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5}},"type":"barpolar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"histogram":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"histogram"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}}},"margin":[5,5,5,5],"name":"Plotly01570","viewport_update_throttle":200},"id":"1139","type":"panel.models.plotly.PlotlyPlot"},{"attributes":{"client_comm_id":"06003f56318946a7afde4a55cc390511","comm_id":"2056a99d7331442d82359b5c90ac0c01","plot_id":"1139"},"id":"1146","type":"panel.models.comm_manager.CommManager"}],"root_ids":["1139","1146"]},"title":"Bokeh Application","version":"2.3.1"}};
    var render_items = [{"docid":"22d39d6d-fbad-43b4-93d8-c532833995f0","root_ids":["1139"],"roots":{"1139":"25d25eb4-0259-45de-b0af-00afb52dd913"}}];
    root.Bokeh.embed.embed_items_notebook(docs_json, render_items);
  }
  if (root.Bokeh !== undefined && root.Bokeh.Panel !== undefined && root['Plotly'] !== undefined ) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined && root.Bokeh.Panel !== undefined && root['Plotly'] !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else if (document.readyState == "complete") {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include sankey_plotly_rotex_piscine_builleur_pac_pv.html %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="R&#233;f&#233;rences">R&#233;f&#233;rences<a class="anchor-link" href="#R&#233;f&#233;rences"> </a></h1><p>{{ "This is the actual footnote" | fndetail: 1 }}
{{ "This is the actual footnote" | fndetail: 2 }}
{{ "This is the actual footnote" | fndetail: 3 }}</p>

</div>
</div>
</div>
</div>
 

